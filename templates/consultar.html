{% extends "base.html" %}

{% block content %}
<h1>Consultar Inventario</h1>

<form method="POST">
    <input type="text" name="nombre" placeholder="Buscar por nombre" value="{{ nombre or '' }}">

    <!-- Menú desplegable de categorías -->
    <select name="categoria_id">
        <option value="">-- Todas las categorías --</option>
        {% for categoria in categorias %}
            <option value="{{ categoria.id }}" {% if categoria.id == categoria_id %}selected{% endif %}>
                {{ categoria.nombre }}
            </option>
        {% endfor %}
    </select>

    <!-- Menú desplegable de sucursales -->
    <select name="sucursal_id">
        <option value="">-- Todas las sucursales --</option>
        {% for sucursal in sucursales %}
            <option value="{{ sucursal.id }}" {% if sucursal.id == sucursal_id %}selected{% endif %}>
                {{ sucursal.nombre }}
            </option>
        {% endfor %}
    </select>

    <button type="submit">Buscar</button>
</form>

{% if resultados %}
<table border="1" cellpadding="5">
    <tr>
        <th>Código</th>
        <th>Nombre</th>
        <th>Precio Venta</th>
        <th>Sucursal</th>
        <th>Cantidad</th>
        <th>Categoría</th>
    </tr>
    {% for producto, categoria, sucursal, ps in resultados %}
    <tr>
        <td>{{ producto.codigo }}</td>
        <td>{{ producto.nombre }}</td>
        <td>{{ producto.precio_venta }}</td>
        <td>{{ sucursal.nombre }}</td>
        <td>{{ ps.cantidad }}</td>
        <td>{{ categoria.nombre }}</td>
    </tr>
    {% endfor %}
</table>
{% endif %}
{% endblock %}
